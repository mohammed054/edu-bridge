const A="http://localhost:5000/api".replace(/\/$/,""),v="edu_bridge_auth_session";class p extends Error{constructor(t,r=0){super(t),this.name="ApiError",this.status=Number(r)}}let c=null,$=!1;const O=()=>{typeof window>"u"||window.dispatchEvent(new CustomEvent("auth:session-expired"))},P=()=>{c=null,$=!1},w=()=>{$||($=!0,O())},x=e=>{if(!e)return!0;try{const[,t]=String(e).split(".");if(!t)return!1;const r=atob(t.replace(/-/g,"+").replace(/_/g,"/")),n=JSON.parse(r);return n!=null&&n.exp?Date.now()>=Number(n.exp)*1e3:!1}catch{return!1}},g=()=>typeof window>"u"?null:window.localStorage,l=()=>{var e;try{const t=(e=g())==null?void 0:e.getItem(v);return t?JSON.parse(t):null}catch{return null}},y=()=>{var e;(e=g())==null||e.removeItem(v)},o=(e={})=>{const t=new URLSearchParams;Object.entries(e).forEach(([n,h])=>{h==null||h===""||t.append(n,String(h))});const r=t.toString();return r?`?${r}`:""},s=async(e,{method:t="GET",token:r,body:n,auth:h=!1}={})=>{var f,S,T;const m={},a=r||((f=l())==null?void 0:f.token);if(n!==void 0&&(m["Content-Type"]="application/json"),h){if(!a)throw new p("انتهت الجلسة. يرجى تسجيل الدخول مرة أخرى.",401);if(c&&c!==a&&P(),c===a||x(a)){const i=(S=l())==null?void 0:S.token;throw c=a,i===a&&y(),w(),new p("انتهت الجلسة. يرجى تسجيل الدخول مرة أخرى.",401)}m.Authorization=`Bearer ${a}`}const u=await fetch(`${A}${e}`,{method:t,headers:m,body:n!==void 0?JSON.stringify(n):void 0});let d={};try{d=await u.json()}catch{d={}}if(!u.ok){if(u.status===401){const i=(T=l())==null?void 0:T.token;c=a||i||null,(!i||!a||i===a)&&(y(),w())}throw new p(d.message||"تعذر تنفيذ الطلب.",u.status)}return d},k=async(e,{method:t="GET",token:r,body:n,auth:h=!1}={})=>{var f,S,T;const m={},a=r||((f=l())==null?void 0:f.token);if(n!==void 0&&(m["Content-Type"]="application/json"),h){if(!a)throw new p("انتهت الجلسة. يرجى تسجيل الدخول مرة أخرى.",401);if(c&&c!==a&&P(),c===a||x(a)){const i=(S=l())==null?void 0:S.token;throw c=a,i===a&&y(),w(),new p("انتهت الجلسة. يرجى تسجيل الدخول مرة أخرى.",401)}m.Authorization=`Bearer ${a}`}const u=await fetch(`${A}${e}`,{method:t,headers:m,body:n!==void 0?JSON.stringify(n):void 0}),d=await u.text();if(!u.ok){if(u.status===401){const E=(T=l())==null?void 0:T.token;c=a||E||null,(!E||!a||E===a)&&(y(),w())}let i={};try{i=d?JSON.parse(d):{}}catch{i={}}throw new p(i.message||"تعذر تنفيذ الطلب.",u.status)}return d},C=(e,t,r={})=>s(`/profile/${t}${o(r)}`,{token:e,auth:!0}),b=e=>s("/student/portal",{token:e,auth:!0}),H=(e,t={})=>s(`/student/schedule${o(t)}`,{token:e,auth:!0}),D=(e,t={})=>s(`/feedback/list${o(t)}`,{token:e,auth:!0}),I=(e,t={})=>s(`/teacher/exams${o(t)}`,{token:e,auth:!0}),L=(e,t)=>s("/teacher/exams",{method:"PATCH",token:e,auth:!0,body:t}),N=(e,t)=>s("/teacher/grades/import/preview",{method:"POST",token:e,auth:!0,body:t}),_=(e,t)=>s("/teacher/grades/import/confirm",{method:"POST",token:e,auth:!0,body:t}),W=(e,t,r)=>s(`/teacher/students/${t}/feedback-draft`,{method:"POST",token:e,auth:!0,body:r}),J=(e,t,r)=>s(`/teacher/students/${t}/term-comment`,{method:"POST",token:e,auth:!0,body:r}),G=(e,t)=>s("/teacher/homework",{method:"POST",token:e,auth:!0,body:t}),R=(e,t,r)=>s(`/teacher/homework/${t}`,{method:"PATCH",token:e,auth:!0,body:r}),j=(e,t,r)=>s(`/teacher/homework/${t}/assignments`,{method:"PATCH",token:e,auth:!0,body:r}),U=(e,t)=>s(`/teacher/homework/${t}`,{method:"DELETE",token:e,auth:!0}),q=(e,t={})=>s(`/teacher/schedule${o(t)}`,{token:e,auth:!0}),B=(e,t)=>s("/teacher/attendance",{method:"POST",token:e,auth:!0,body:t}),F=(e,t)=>s("/teacher/incidents",{method:"POST",token:e,auth:!0,body:t}),M=e=>s("/teacher/dashboard-insights",{token:e,auth:!0}),V=(e,t)=>s("/teacher/announcements",{method:"POST",token:e,auth:!0,body:t}),z=(e,t,r)=>s(`/teacher/announcements/${t}`,{method:"PATCH",token:e,auth:!0,body:r}),K=(e,t)=>s(`/teacher/announcements/${t}`,{method:"DELETE",token:e,auth:!0}),Q=e=>s("/admin/overview",{token:e,auth:!0}),Y=(e,t={})=>s(`/admin/schedule${o(t)}`,{token:e,auth:!0}),X=(e,t)=>s("/admin/schedule/entries",{method:"POST",token:e,auth:!0,body:t}),Z=(e,t,r)=>s(`/admin/schedule/entries/${t}`,{method:"PATCH",token:e,auth:!0,body:r}),ee=(e,t)=>s(`/admin/schedule/entries/${t}`,{method:"DELETE",token:e,auth:!0}),te=(e,t)=>s("/admin/schedule/suggest-slot",{method:"POST",token:e,auth:!0,body:t}),se=(e,t)=>s("/admin/schedule/pattern-copy",{method:"POST",token:e,auth:!0,body:t}),re=(e,t)=>s("/admin/schedule/import/preview",{method:"POST",token:e,auth:!0,body:t}),ae=(e,t)=>s("/admin/schedule/import/confirm",{method:"POST",token:e,auth:!0,body:t}),ne=e=>s("/admin/surveys",{token:e,auth:!0}),oe=(e,t)=>s("/admin/surveys",{method:"POST",token:e,auth:!0,body:t}),ie=(e,t,r)=>s(`/admin/surveys/${t}`,{method:"PATCH",token:e,auth:!0,body:r}),ce=(e,t)=>s(`/admin/surveys/${t}`,{method:"DELETE",token:e,auth:!0}),ue=(e,t,r={})=>s(`/admin/import-users${o(r)}`,{method:"POST",token:e,auth:!0,body:t}),he=e=>s("/admin/enterprise/hierarchy",{token:e,auth:!0}),de=(e,t={})=>s(`/admin/enterprise/dashboard${o(t)}`,{token:e,auth:!0}),me=(e,t={})=>s(`/admin/enterprise/students${o(t)}`,{token:e,auth:!0}),pe=(e,t)=>s("/admin/enterprise/students/bulk-update",{method:"POST",token:e,auth:!0,body:t}),le=(e,t={})=>k(`/admin/enterprise/students/export${o(t)}`,{token:e,auth:!0}),fe=(e,t)=>s(`/admin/enterprise/students/${t}`,{token:e,auth:!0}),Se=(e,t={})=>s(`/admin/enterprise/teachers${o(t)}`,{token:e,auth:!0}),Te=(e,t)=>s(`/admin/enterprise/teachers/${t}`,{token:e,auth:!0}),we=e=>s("/admin/enterprise/classes",{token:e,auth:!0}),ye=(e,t)=>s(`/admin/enterprise/classes/${t}`,{token:e,auth:!0}),ke=(e,t,r)=>s(`/admin/enterprise/classes/${t}`,{method:"PATCH",token:e,auth:!0,body:r}),Ee=(e,t)=>k(`/admin/enterprise/classes/${t}/roster-export`,{token:e,auth:!0}),$e=(e,t={})=>s(`/admin/enterprise/views${o(t)}`,{token:e,auth:!0}),Ae=(e,t)=>s("/admin/enterprise/views",{method:"POST",token:e,auth:!0,body:t}),ve=(e,t)=>s(`/admin/enterprise/views/${t}`,{method:"DELETE",token:e,auth:!0}),Pe=e=>s("/admin/enterprise/system/context",{token:e,auth:!0}),xe=(e,t)=>s("/admin/enterprise/system/context",{method:"PATCH",token:e,auth:!0,body:t}),ge=e=>s("/admin/enterprise/system/permissions",{token:e,auth:!0}),Oe=(e,t)=>s("/admin/enterprise/system/permissions",{method:"PATCH",token:e,auth:!0,body:t}),Ce=(e,t={})=>s(`/admin/enterprise/notifications/workflow${o(t)}`,{token:e,auth:!0}),be=(e,t,r)=>s(`/admin/enterprise/notifications/workflow/${t}`,{method:"PATCH",token:e,auth:!0,body:r}),He=(e,t={})=>s(`/admin/enterprise/tickets/workflow${o(t)}`,{token:e,auth:!0}),De=(e,t,r)=>s(`/admin/enterprise/tickets/workflow/${t}`,{method:"PATCH",token:e,auth:!0,body:r}),Ie=e=>k("/admin/enterprise/tickets/workflow/export",{token:e,auth:!0}),Le=e=>s("/admin/enterprise/surveys/lifecycle",{token:e,auth:!0}),Ne=(e,t,r)=>s(`/admin/enterprise/surveys/lifecycle/${t}`,{method:"PATCH",token:e,auth:!0,body:r}),_e=(e,t)=>k(`/admin/enterprise/surveys/${t}/raw-export`,{token:e,auth:!0}),We=e=>s("/admin/enterprise/observability",{token:e,auth:!0});export{_ as $,De as A,Ie as B,ne as C,Le as D,ie as E,oe as F,ce as G,Ne as H,_e as I,Ce as J,be as K,ue as L,Pe as M,ge as N,We as O,xe as P,Oe as Q,p as R,I as S,M as T,z as U,V,R as W,G as X,j as Y,L as Z,N as _,he as a,W as a0,J as a1,U as a2,K as a3,C as a4,q as a5,B as a6,F as a7,b as a8,H as a9,$e as b,me as c,pe as d,le as e,de as f,Ae as g,ve as h,fe as i,Se as j,Te as k,we as l,ye as m,Ee as n,Q as o,Z as p,X as q,ee as r,te as s,se as t,ke as u,re as v,ae as w,Y as x,He as y,D as z};
