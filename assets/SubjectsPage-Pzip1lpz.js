import{a as j,r as t,j as e}from"./index-df1SZI71.js";import{o as f}from"./api-x0wxRGLh.js";import{P as N}from"./PageHeading-CUjM0fdU.js";function y(){const{token:l}=j(),[u,n]=t.useState(!0),[o,i]=t.useState(""),[d,p]=t.useState([]),[m,x]=t.useState([]);t.useEffect(()=>{let s=!0;return(async()=>{try{n(!0),i("");const a=await f(l);if(!s)return;p(a.availableSubjects||[]),x(a.teachers||[])}catch(a){s&&i(a.message||"تعذر تحميل بيانات المواد.")}finally{s&&n(!1)}})(),()=>{s=!1}},[l]);const h=t.useMemo(()=>d.map(s=>{const r=m.filter(c=>c.subject===s),a=new Set;return r.forEach(c=>{(c.classes||[]).forEach(g=>a.add(g))}),{name:s,teachersCount:r.length,classesCount:a.size}}),[d,m]);return e.jsxs("div",{className:"page-enter space-y-5 p-1",children:[e.jsx(N,{title:"إدارة المواد",subtitle:"متابعة توزيع المواد على المعلمين والصفوف."}),o?e.jsx("p",{className:"rounded-sm border border-danger/25 bg-danger/5 px-3 py-2 text-sm text-danger",children:o}):null,e.jsx("section",{className:"panel-card",children:u?e.jsxs("div",{className:"grid gap-3 sm:grid-cols-2 xl:grid-cols-4",children:[e.jsx("div",{className:"skeleton h-[120px]"}),e.jsx("div",{className:"skeleton h-[120px]"}),e.jsx("div",{className:"skeleton h-[120px]"}),e.jsx("div",{className:"skeleton h-[120px]"})]}):e.jsx("div",{className:"grid gap-3 sm:grid-cols-2 xl:grid-cols-4",children:h.map(s=>e.jsxs("article",{className:"panel-card-hover",children:[e.jsx("h2",{className:"text-lg font-semibold text-text-primary",children:s.name}),e.jsxs("div",{className:"mt-2 space-y-1",children:[e.jsxs("p",{className:"caption-premium",children:["الصفوف: ",Number(s.classesCount||0).toLocaleString("en-US")]}),e.jsxs("p",{className:"caption-premium",children:["المعلمون: ",Number(s.teachersCount||0).toLocaleString("en-US")]})]})]},s.name))})})]})}export{y as default};
