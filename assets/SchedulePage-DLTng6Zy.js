import{a as Te,r as d,j as a}from"./index-df1SZI71.js";import{p as G,q as Oe,r as Ee,s as De,t as Fe,v as Ae,w as Re,o as $e,x as We}from"./api-x0wxRGLh.js";import{P as Pe}from"./PageHeading-CUjM0fdU.js";import{u as Me}from"./AdminEnterpriseContext-BE79oEoc.js";const E=[{value:1,label:"Monday"},{value:2,label:"Tuesday"},{value:3,label:"Wednesday"},{value:4,label:"Thursday"},{value:5,label:"Friday"}],ce={className:"",teacherId:"",subject:"",dayOfWeek:1,startTime:"08:00",endTime:"08:45",room:"",allowConflicts:!1},oe=n=>{const b=String(n||"").trim().split(":");if(b.length!==2)return-1;const u=Number(b[0]),p=Number(b[1]);return!Number.isFinite(u)||!Number.isFinite(p)?-1:u*60+p},Be=n=>{const c=Math.max(0,Math.min(1439,Number(n||0))),b=String(Math.floor(c/60)).padStart(2,"0"),u=String(c%60).padStart(2,"0");return`${b}:${u}`},Ue=n=>{const c=(n==null?void 0:n.conflictFlags)||[];return c.length?c.join(", "):""},ne=({classes:n,teachers:c,subjects:b})=>{var $,i;const u=(($=n==null?void 0:n[0])==null?void 0:$.name)||"",p=(c==null?void 0:c[0])||null,x=(p==null?void 0:p.subject)||((i=p==null?void 0:p.subjects)==null?void 0:i[0])||"";return{...ce,className:u,teacherId:(p==null?void 0:p.id)||"",subject:x||(b==null?void 0:b[0])||""}},Le=n=>new Promise((c,b)=>{const u=new FileReader;u.onload=()=>c(String(u.result||"")),u.onerror=()=>b(new Error("Failed to read image file.")),u.readAsDataURL(n)});function Ye(){var ee,ae,se;const{token:n}=Te(),{selectedClass:c}=Me(),[b,u]=d.useState(!0),[p,x]=d.useState(!1),[$,i]=d.useState(""),[V,y]=d.useState(""),[z,de]=d.useState([]),[D,ie]=d.useState([]),[W,me]=d.useState([]),[Y,ue]=d.useState([]),[pe,he]=d.useState([]),[N,xe]=d.useState({grade:"",teacherId:"",day:""}),[h,g]=d.useState(ce),[F,q]=d.useState(""),[v,I]=d.useState({className:"",teacherId:"",dayOfWeek:1,room:"",durationMinutes:45}),[H,K]=d.useState([]),[A,T]=d.useState({fromClassName:"",toClassName:"",fromDay:"",toDay:"",allowConflicts:!1}),[f,R]=d.useState({className:"",teacherId:"",ocrText:"",fileDataUrl:""}),[w,k]=d.useState(null),[B,P]=d.useState(!1),[Q,J]=d.useState(""),be=async()=>{const e=await $e(n),s=e.teachers||[],t=e.classes||[],r=e.availableSubjects||[],o=[...new Set(t.map(l=>l.grade).filter(Boolean))];me(s),ie(t),ue(r),he(o),g(l=>{const m=ne({classes:t,teachers:s,subjects:r});return{...m,...l,className:l.className||m.className,teacherId:l.teacherId||m.teacherId,subject:l.subject||m.subject}}),I(l=>{var m,C;return{...l,className:l.className||((m=t==null?void 0:t[0])==null?void 0:m.name)||"",teacherId:l.teacherId||((C=s==null?void 0:s[0])==null?void 0:C.id)||""}}),T(l=>{var m,C,M;return{...l,fromClassName:l.fromClassName||((m=t==null?void 0:t[0])==null?void 0:m.name)||"",toClassName:l.toClassName||((C=t==null?void 0:t[1])==null?void 0:C.name)||((M=t==null?void 0:t[0])==null?void 0:M.name)||""}}),R(l=>{var m,C;return{...l,className:l.className||((m=t==null?void 0:t[0])==null?void 0:m.name)||"",teacherId:l.teacherId||((C=s==null?void 0:s[0])==null?void 0:C.id)||""}})},S=async(e=N)=>{const s=await We(n,e);de(s.entries||[])};d.useEffect(()=>{let e=!0;return(async()=>{try{if(u(!0),i(""),y(""),await be(),!e)return;await S()}catch(t){e&&i((t==null?void 0:t.message)||"Failed to load schedule data.")}finally{e&&u(!1)}})(),()=>{e=!1}},[n]),d.useEffect(()=>{c!=null&&c.name&&(g(e=>({...e,className:e.className||c.name})),I(e=>({...e,className:e.className||c.name})),T(e=>({...e,fromClassName:e.fromClassName||c.name,toClassName:e.toClassName||c.name})),R(e=>({...e,className:e.className||c.name})))},[c==null?void 0:c.name]);const X=d.useMemo(()=>{const e=E.reduce((s,t)=>(s[t.value]=[],s),{});return(z||[]).forEach(s=>{const t=Number(s.dayOfWeek||0);e[t]||(e[t]=[]),e[t].push(s)}),Object.keys(e).forEach(s=>{e[s]=e[s].slice().sort((t,r)=>String(t.startTime).localeCompare(String(r.startTime)))}),e},[z]),U=async e=>{const s={...N,...e};xe(s);try{u(!0),await S(s)}catch(t){i((t==null?void 0:t.message)||"Failed to apply schedule filters.")}finally{u(!1)}},L=()=>{q(""),g(ne({classes:D,teachers:W,subjects:Y}))},ge=async e=>{e.preventDefault();try{x(!0),i(""),y("");const s={className:h.className,teacherId:h.teacherId,subject:h.subject,dayOfWeek:Number(h.dayOfWeek),startTime:h.startTime,endTime:h.endTime,room:h.room,allowConflicts:h.allowConflicts===!0};F?(await G(n,F,s),y("Schedule block updated.")):(await Oe(n,s),y("Schedule block created.")),await S(N),L()}catch(s){i((s==null?void 0:s.message)||"Failed to save schedule block.")}finally{x(!1)}},fe=async e=>{if(window.confirm(`Delete schedule block ${e.className} ${e.subject}?`))try{x(!0),i(""),y(""),await Ee(n,e.id),y("Schedule block deleted."),await S(N),F===e.id&&L()}catch(s){i((s==null?void 0:s.message)||"Failed to delete schedule block.")}finally{x(!1)}},ye=e=>{q(e.id),g({className:e.className||"",teacherId:e.teacherId||"",subject:e.subject||"",dayOfWeek:Number(e.dayOfWeek||1),startTime:e.startTime||"08:00",endTime:e.endTime||"08:45",room:e.room||"",allowConflicts:!1})},Z=async(e,s)=>{const t=oe(e.startTime),r=oe(e.endTime);if(t<0||r<0)return;const o=Math.max(t+15,r+s);try{x(!0),await G(n,e.id,{endTime:Be(o),allowConflicts:!0}),await S(N),y("Block duration updated.")}catch(l){i(l.message||"Failed to resize block.")}finally{x(!1)}},Ne=async e=>{if(Q)try{x(!0),await G(n,Q,{dayOfWeek:e,allowConflicts:!0}),await S(N),y("Block moved to new day.")}catch(s){i(s.message||"Failed to move block.")}finally{x(!1),J("")}},je=async()=>{try{x(!0),i("");const e=await De(n,v);K(e.suggestions||[])}catch(e){i(e.message||"Failed to suggest available slots."),K([])}finally{x(!1)}},ve=e=>{g(s=>({...s,className:v.className,teacherId:v.teacherId,dayOfWeek:Number(e.dayOfWeek||1),startTime:e.startTime||s.startTime,endTime:e.endTime||s.endTime,room:v.room||s.room})),y("Suggestion applied to editor form.")},we=async()=>{try{x(!0),i("");const e=await Fe(n,A);y(`Pattern copy complete. Created ${Number(e.copiedCount||0)} blocks.`),await S(N)}catch(e){i(e.message||"Failed to copy schedule pattern.")}finally{x(!1)}},Ce=async()=>{var e,s;try{P(!0),i("");const t={1:{start:"08:00",end:"08:45"},2:{start:"08:45",end:"09:30"},3:{start:"09:30",end:"10:15"},4:{start:"10:30",end:"11:15"},5:{start:"11:15",end:"12:00"},6:{start:"12:30",end:"13:15"},7:{start:"13:15",end:"14:00"}},r={monday:1,tuesday:2,wednesday:3,thursday:4,friday:5,saturday:6,sunday:7,الاثنين:1,الثلاثاء:2,الاربعاء:3,الأربعاء:3,الخميس:4,الجمعة:5,السبت:6,الاحد:7,الأحد:7};let o=[];if(f.ocrText.includes(",")&&f.ocrText.toLowerCase().includes("day")){const m=f.ocrText.split(`
`).map(O=>O.trim()).filter(Boolean);if(m.length<2)throw new Error("Invalid schedule format.");const M=m[0].split(",").map(O=>O.trim()).slice(1).map(O=>parseInt(O));m.slice(1).forEach(O=>{const te=O.split(",").map(j=>j.trim()),re=te[0].toLowerCase(),le=Object.keys(r).find(j=>re.includes(j))!==void 0?r[Object.keys(r).find(j=>re.includes(j))]:null;le&&te.slice(1).forEach((j,Se)=>{if(!j||j==="-"||j==="—")return;const Ie=M[Se],_=t[Ie];_&&o.push({dayOfWeek:le,startTime:_.start,endTime:_.end,subject:j.trim(),room:f.defaultRoom||""})})}),P(!1);return}const l=await Ae(n,{className:f.className,teacherId:f.teacherId,ocrText:f.ocrText,fileDataUrl:f.fileDataUrl});k(l)}catch(t){console.error(t),i(((s=(e=t.response)==null?void 0:e.data)==null?void 0:s.message)||t.message||"Failed to preview OCR data")}finally{P(!1)}},ke=async()=>{var e;if((e=w==null?void 0:w.rows)!=null&&e.length)try{P(!0),i("");const s=await Re(n,{className:f.className,teacherId:f.teacherId,rows:w.rows,allowConflicts:!0});y(`OCR import complete. Created ${Number(s.createdCount||0)} rows.`),k(null),await S(N)}catch(s){i(s.message||"Failed to import OCR rows.")}finally{P(!1)}};return a.jsxs("div",{className:"page-enter space-y-5 p-1",children:[a.jsx(Pe,{title:"Enterprise Scheduling Engine",subtitle:"Visual weekly timetable, conflict detection, auto-slot suggestions, pattern copy, and OCR-assisted import."}),$?a.jsx("p",{className:"rounded-sm border border-danger/25 bg-danger/5 px-3 py-2 text-sm text-danger",children:$}):null,V?a.jsx("p",{className:"rounded-sm border border-success/25 bg-success/10 px-3 py-2 text-sm text-success",children:V}):null,a.jsx("section",{className:"panel-card",children:a.jsxs("div",{className:"grid gap-3 md:grid-cols-3",children:[a.jsxs("select",{value:N.grade,onChange:e=>U({grade:e.target.value}),className:"focus-ring rounded-sm border border-border bg-white px-3 py-2 text-sm",children:[a.jsx("option",{value:"",children:"All grades"}),pe.map(e=>a.jsx("option",{value:e,children:e},e))]}),a.jsxs("select",{value:N.teacherId,onChange:e=>U({teacherId:e.target.value}),className:"focus-ring rounded-sm border border-border bg-white px-3 py-2 text-sm",children:[a.jsx("option",{value:"",children:"All teachers"}),W.map(e=>a.jsx("option",{value:e.id,children:e.name},e.id))]}),a.jsxs("select",{value:N.day,onChange:e=>U({day:e.target.value}),className:"focus-ring rounded-sm border border-border bg-white px-3 py-2 text-sm",children:[a.jsx("option",{value:"",children:"All days"}),E.map(e=>a.jsx("option",{value:e.value,children:e.label},e.value))]})]})}),a.jsxs("section",{className:"panel-card space-y-3",children:[a.jsx("h2",{className:"text-base font-semibold text-text-primary",children:"Weekly Visual Timetable Grid (Drag to Move)"}),b?a.jsxs("div",{className:"grid gap-2",children:[a.jsx("div",{className:"skeleton h-24"}),a.jsx("div",{className:"skeleton h-24"})]}):a.jsx("div",{className:"grid gap-3 lg:grid-cols-5",children:E.map(e=>{var s;return a.jsxs("div",{className:"rounded-sm border border-border bg-background p-2",onDragOver:t=>t.preventDefault(),onDrop:()=>Ne(e.value),children:[a.jsx("h3",{className:"mb-2 text-sm font-semibold text-text-primary",children:e.label}),a.jsxs("div",{className:"space-y-2",children:[(X[e.value]||[]).map(t=>{var r,o;return a.jsxs("article",{draggable:!0,onDragStart:()=>J(t.id),className:`rounded-sm border p-2 text-xs ${(r=t.conflictFlags)!=null&&r.length?"border-danger/40 bg-danger/5":"border-border bg-white"}`,children:[a.jsxs("p",{className:"font-semibold text-text-primary",children:[t.startTime," - ",t.endTime]}),a.jsxs("p",{className:"text-text-secondary",children:[t.className," | ",t.subject]}),a.jsxs("p",{className:"text-text-secondary",children:[t.teacherName||"-"," | Room ",t.room||"-"]}),(o=t.conflictFlags)!=null&&o.length?a.jsxs("p",{className:"mt-1 text-danger",children:["Conflict: ",Ue(t)]}):null,a.jsxs("div",{className:"mt-2 flex flex-wrap gap-1",children:[a.jsx("button",{type:"button",className:"action-btn px-2 py-1 text-[11px]",onClick:()=>ye(t),children:"Edit"}),a.jsx("button",{type:"button",className:"action-btn px-2 py-1 text-[11px]",onClick:()=>fe(t),children:"Delete"}),a.jsx("button",{type:"button",className:"action-btn px-2 py-1 text-[11px]",onClick:()=>Z(t,-5),children:"-5m"}),a.jsx("button",{type:"button",className:"action-btn px-2 py-1 text-[11px]",onClick:()=>Z(t,5),children:"+5m"})]})]},t.id)}),(s=X[e.value])!=null&&s.length?null:a.jsx("p",{className:"text-xs text-text-secondary",children:"No blocks"})]})]},`day-col-${e.value}`)})})]}),a.jsxs("section",{className:"panel-card space-y-3",children:[a.jsx("h2",{className:"text-base font-semibold text-text-primary",children:F?"Edit Schedule Block":"Create Schedule Block"}),a.jsxs("form",{className:"grid gap-3 lg:grid-cols-4",onSubmit:ge,children:[a.jsx("select",{value:h.className,onChange:e=>g(s=>({...s,className:e.target.value})),className:"focus-ring rounded-sm border border-border bg-white px-3 py-2 text-sm",children:D.map(e=>a.jsx("option",{value:e.name,children:e.name},e.id))}),a.jsx("select",{value:h.teacherId,onChange:e=>g(s=>({...s,teacherId:e.target.value})),className:"focus-ring rounded-sm border border-border bg-white px-3 py-2 text-sm",children:W.map(e=>a.jsx("option",{value:e.id,children:e.name},e.id))}),a.jsx("select",{value:h.subject,onChange:e=>g(s=>({...s,subject:e.target.value})),className:"focus-ring rounded-sm border border-border bg-white px-3 py-2 text-sm",children:Y.map(e=>a.jsx("option",{value:e,children:e},e))}),a.jsx("select",{value:String(h.dayOfWeek),onChange:e=>g(s=>({...s,dayOfWeek:Number(e.target.value)})),className:"focus-ring rounded-sm border border-border bg-white px-3 py-2 text-sm",children:E.map(e=>a.jsx("option",{value:e.value,children:e.label},e.value))}),a.jsx("input",{type:"time",value:h.startTime,onChange:e=>g(s=>({...s,startTime:e.target.value})),className:"focus-ring rounded-sm border border-border px-3 py-2 text-sm"}),a.jsx("input",{type:"time",value:h.endTime,onChange:e=>g(s=>({...s,endTime:e.target.value})),className:"focus-ring rounded-sm border border-border px-3 py-2 text-sm"}),a.jsx("input",{value:h.room,onChange:e=>g(s=>({...s,room:e.target.value})),className:"focus-ring rounded-sm border border-border px-3 py-2 text-sm",placeholder:"Room"}),a.jsxs("label",{className:"inline-flex items-center gap-2 rounded-sm border border-border bg-background px-3 py-2 text-sm",children:[a.jsx("input",{type:"checkbox",checked:h.allowConflicts,onChange:e=>g(s=>({...s,allowConflicts:e.target.checked}))}),"Allow conflicts"]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{type:"submit",className:"action-btn-primary",disabled:p,children:F?"Update Block":"Create Block"}),F?a.jsx("button",{type:"button",className:"action-btn",onClick:L,children:"Cancel Edit"}):null]})]})]}),a.jsxs("section",{className:"panel-card space-y-3",children:[a.jsx("h2",{className:"text-base font-semibold text-text-primary",children:"Intelligent Time Allocation"}),a.jsxs("div",{className:"grid gap-3 md:grid-cols-5",children:[a.jsx("select",{value:v.className,onChange:e=>I(s=>({...s,className:e.target.value})),className:"focus-ring rounded-sm border border-border bg-white px-3 py-2 text-sm",children:D.map(e=>a.jsx("option",{value:e.name,children:e.name},`s-class-${e.id}`))}),a.jsx("select",{value:v.teacherId,onChange:e=>I(s=>({...s,teacherId:e.target.value})),className:"focus-ring rounded-sm border border-border bg-white px-3 py-2 text-sm",children:W.map(e=>a.jsx("option",{value:e.id,children:e.name},`s-teacher-${e.id}`))}),a.jsx("select",{value:String(v.dayOfWeek),onChange:e=>I(s=>({...s,dayOfWeek:Number(e.target.value)})),className:"focus-ring rounded-sm border border-border bg-white px-3 py-2 text-sm",children:E.map(e=>a.jsx("option",{value:e.value,children:e.label},`s-day-${e.value}`))}),a.jsx("input",{value:v.room,onChange:e=>I(s=>({...s,room:e.target.value})),className:"focus-ring rounded-sm border border-border px-3 py-2 text-sm",placeholder:"Room (optional)"}),a.jsx("input",{type:"number",min:15,step:5,value:v.durationMinutes,onChange:e=>I(s=>({...s,durationMinutes:Number(e.target.value||45)})),className:"focus-ring rounded-sm border border-border px-3 py-2 text-sm",placeholder:"Duration"})]}),a.jsx("button",{type:"button",className:"action-btn-primary",onClick:je,disabled:p,children:"Suggest Available Slots"}),a.jsxs("div",{className:"space-y-2",children:[H.map((e,s)=>a.jsxs("article",{className:"rounded-sm border border-border bg-background p-2 text-sm",children:[a.jsxs("p",{className:"font-semibold text-text-primary",children:["Day ",e.dayOfWeek," | ",e.startTime," - ",e.endTime]}),a.jsx("button",{type:"button",className:"action-btn mt-2",onClick:()=>ve(e),children:"Use in Editor"})]},`${e.dayOfWeek}-${e.startTime}-${s}`)),H.length?null:a.jsx("p",{className:"text-xs text-text-secondary",children:"No suggestions loaded yet."})]})]}),a.jsxs("section",{className:"panel-card space-y-3",children:[a.jsx("h2",{className:"text-base font-semibold text-text-primary",children:"Pattern Replication"}),a.jsxs("div",{className:"grid gap-3 md:grid-cols-5",children:[a.jsx("select",{value:A.fromClassName,onChange:e=>T(s=>({...s,fromClassName:e.target.value})),className:"focus-ring rounded-sm border border-border bg-white px-3 py-2 text-sm",children:D.map(e=>a.jsxs("option",{value:e.name,children:["From: ",e.name]},`from-${e.id}`))}),a.jsx("select",{value:A.toClassName,onChange:e=>T(s=>({...s,toClassName:e.target.value})),className:"focus-ring rounded-sm border border-border bg-white px-3 py-2 text-sm",children:D.map(e=>a.jsxs("option",{value:e.name,children:["To: ",e.name]},`to-${e.id}`))}),a.jsxs("select",{value:A.fromDay,onChange:e=>T(s=>({...s,fromDay:e.target.value})),className:"focus-ring rounded-sm border border-border bg-white px-3 py-2 text-sm",children:[a.jsx("option",{value:"",children:"All days"}),E.map(e=>a.jsxs("option",{value:e.value,children:["From day: ",e.label]},`from-day-${e.value}`))]}),a.jsxs("select",{value:A.toDay,onChange:e=>T(s=>({...s,toDay:e.target.value})),className:"focus-ring rounded-sm border border-border bg-white px-3 py-2 text-sm",children:[a.jsx("option",{value:"",children:"Keep original day"}),E.map(e=>a.jsxs("option",{value:e.value,children:["To day: ",e.label]},`to-day-${e.value}`))]}),a.jsxs("label",{className:"inline-flex items-center gap-2 rounded-sm border border-border bg-background px-3 py-2 text-sm",children:[a.jsx("input",{type:"checkbox",checked:A.allowConflicts,onChange:e=>T(s=>({...s,allowConflicts:e.target.checked}))}),"Allow conflicts"]})]}),a.jsx("button",{type:"button",className:"action-btn-primary",onClick:we,disabled:p,children:"Copy Schedule Pattern"})]}),a.jsxs("section",{className:"panel-card space-y-3",children:[a.jsx("h2",{className:"text-base font-semibold text-text-primary",children:"OCR Schedule Import"}),a.jsxs("div",{className:"grid gap-3 md:grid-cols-3",children:[a.jsx("select",{value:f.className,onChange:e=>R(s=>({...s,className:e.target.value})),className:"focus-ring rounded-sm border border-border bg-white px-3 py-2 text-sm",children:D.map(e=>a.jsx("option",{value:e.name,children:e.name},`ocr-class-${e.id}`))}),a.jsx("select",{value:f.teacherId,onChange:e=>R(s=>({...s,teacherId:e.target.value})),className:"focus-ring rounded-sm border border-border bg-white px-3 py-2 text-sm",children:W.map(e=>a.jsx("option",{value:e.id,children:e.name},`ocr-teacher-${e.id}`))}),a.jsx("input",{type:"file",accept:"image/*",className:"focus-ring rounded-sm border border-border bg-white px-3 py-2 text-sm",onChange:async e=>{var t;const s=(t=e.target.files)==null?void 0:t[0];if(s)try{const r=await Le(s);R(o=>({...o,fileDataUrl:r}))}catch{i("Failed to parse selected image.")}}})]}),a.jsx("textarea",{value:f.ocrText,onChange:e=>R(s=>({...s,ocrText:e.target.value})),className:"focus-ring min-h-[120px] w-full rounded-sm border border-border px-3 py-2 text-sm",placeholder:"Paste OCR text here..."}),a.jsx("button",{type:"button",className:"action-btn-primary",onClick:Ce,disabled:B,children:"Preview OCR Import"}),B?a.jsxs("div",{className:"grid gap-2",children:[a.jsx("div",{className:"skeleton h-12"}),a.jsx("div",{className:"skeleton h-12"})]}):w?a.jsxs("div",{className:"space-y-3",children:[a.jsxs("p",{className:"text-xs text-text-secondary",children:["Rows: ",Number(((ee=w.summary)==null?void 0:ee.totalRows)||0)," | Valid: ",Number(((ae=w.summary)==null?void 0:ae.validRows)||0)," | Conflicts: ",Number(((se=w.summary)==null?void 0:se.conflictRows)||0)]}),a.jsx("div",{className:"overflow-auto",children:a.jsxs("table",{className:"min-w-full border-collapse text-left text-xs",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b border-border",children:[a.jsx("th",{className:"px-2 py-1",children:"Skip"}),a.jsx("th",{className:"px-2 py-1",children:"Day"}),a.jsx("th",{className:"px-2 py-1",children:"Start"}),a.jsx("th",{className:"px-2 py-1",children:"End"}),a.jsx("th",{className:"px-2 py-1",children:"Subject"}),a.jsx("th",{className:"px-2 py-1",children:"Room"}),a.jsx("th",{className:"px-2 py-1",children:"Issues"}),a.jsx("th",{className:"px-2 py-1",children:"Conflicts"})]})}),a.jsx("tbody",{children:(w.rows||[]).map((e,s)=>a.jsxs("tr",{className:"border-b border-border/60",children:[a.jsx("td",{className:"px-2 py-1",children:a.jsx("input",{type:"checkbox",checked:e.skip===!0,onChange:t=>k(r=>({...r,rows:(r.rows||[]).map((o,l)=>l===s?{...o,skip:t.target.checked}:o)}))})}),a.jsx("td",{className:"px-2 py-1",children:a.jsx("input",{value:e.dayOfWeek||"",onChange:t=>k(r=>({...r,rows:(r.rows||[]).map((o,l)=>l===s?{...o,dayOfWeek:Number(t.target.value||1)}:o)})),className:"focus-ring w-16 rounded-sm border border-border px-2 py-1 text-xs"})}),a.jsx("td",{className:"px-2 py-1",children:a.jsx("input",{value:e.startTime||"",onChange:t=>k(r=>({...r,rows:(r.rows||[]).map((o,l)=>l===s?{...o,startTime:t.target.value}:o)})),className:"focus-ring w-20 rounded-sm border border-border px-2 py-1 text-xs"})}),a.jsx("td",{className:"px-2 py-1",children:a.jsx("input",{value:e.endTime||"",onChange:t=>k(r=>({...r,rows:(r.rows||[]).map((o,l)=>l===s?{...o,endTime:t.target.value}:o)})),className:"focus-ring w-20 rounded-sm border border-border px-2 py-1 text-xs"})}),a.jsx("td",{className:"px-2 py-1",children:a.jsx("input",{value:e.subject||"",onChange:t=>k(r=>({...r,rows:(r.rows||[]).map((o,l)=>l===s?{...o,subject:t.target.value}:o)})),className:"focus-ring w-28 rounded-sm border border-border px-2 py-1 text-xs"})}),a.jsx("td",{className:"px-2 py-1",children:a.jsx("input",{value:e.room||"",onChange:t=>k(r=>({...r,rows:(r.rows||[]).map((o,l)=>l===s?{...o,room:t.target.value}:o)})),className:"focus-ring w-20 rounded-sm border border-border px-2 py-1 text-xs"})}),a.jsx("td",{className:"px-2 py-1",children:(e.issues||[]).join(", ")||"-"}),a.jsx("td",{className:"px-2 py-1",children:(e.conflictFlags||[]).join(", ")||"-"})]},`ocr-row-${s}`))})]})}),a.jsx("button",{type:"button",className:"action-btn-primary",onClick:ke,disabled:B,children:"Confirm OCR Import"})]}):a.jsx("p",{className:"text-xs text-text-secondary",children:"Run preview to review extracted rows before import."})]})]})}export{Ye as default};
