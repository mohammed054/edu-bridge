import{j as e,a as k,c as B,N as W,r as j,O as A}from"./index-df1SZI71.js";import{f as E}from"./api-x0wxRGLh.js";import{u as w,A as H}from"./AdminEnterpriseContext-BE79oEoc.js";function z({className:t="h-5 w-5"}){return e.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",className:t,children:e.jsx("path",{d:"M3 12h8V3H3v9zm10 9h8v-6h-8v6zM13 3v8h8V3h-8zM3 21h8v-6H3v6z"})})}function L({className:t="h-5 w-5"}){return e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",className:t,children:[e.jsx("path",{d:"M16 19a4 4 0 0 0-8 0"}),e.jsx("circle",{cx:"12",cy:"10",r:"3"}),e.jsx("path",{d:"M20 19a4 4 0 0 0-3-3.87M4 19a4 4 0 0 1 3-3.87"})]})}function V({className:t="h-5 w-5"}){return e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",className:t,children:[e.jsx("path",{d:"M12 3 2 8l10 5 10-5-10-5Z"}),e.jsx("path",{d:"m6 10 0 4c0 2.2 2.7 4 6 4s6-1.8 6-4v-4"})]})}function T({className:t="h-5 w-5"}){return e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",className:t,children:[e.jsx("rect",{x:"3",y:"5",width:"18",height:"14",rx:"2"}),e.jsx("path",{d:"M7 9h10M7 13h6"})]})}function $({className:t="h-5 w-5"}){return e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",className:t,children:[e.jsx("path",{d:"M4 19.5A2.5 2.5 0 0 1 6.5 17H20"}),e.jsx("path",{d:"M6.5 2H20v15H6.5A2.5 2.5 0 0 0 4 19.5V4.5A2.5 2.5 0 0 1 6.5 2z"})]})}function G({className:t="h-5 w-5"}){return e.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",className:t,children:e.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H8l-5 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v10z"})})}function O({className:t="h-5 w-5"}){return e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",className:t,children:[e.jsx("path",{d:"M9 11l3 3L22 4"}),e.jsx("path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"})]})}function R({className:t="h-5 w-5"}){return e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",className:t,children:[e.jsx("rect",{x:"3",y:"4",width:"18",height:"17",rx:"2"}),e.jsx("path",{d:"M8 2v4M16 2v4M3 10h18"}),e.jsx("path",{d:"M8 14h3M13 14h3M8 18h3M13 18h3"})]})}function D({className:t="h-5 w-5"}){return e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",className:t,children:[e.jsx("path",{d:"M12 3v12"}),e.jsx("path",{d:"m7 10 5 5 5-5"}),e.jsx("path",{d:"M5 21h14a2 2 0 0 0 2-2v-3"}),e.jsx("path",{d:"M3 16v3a2 2 0 0 0 2 2"})]})}function N({className:t="h-5 w-5"}){return e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",className:t,children:[e.jsx("path",{d:"M15 17h5l-1.4-1.4A2 2 0 0 1 18 14.2V11a6 6 0 1 0-12 0v3.2a2 2 0 0 1-.6 1.4L4 17h5"}),e.jsx("path",{d:"M10 17a2 2 0 0 0 4 0"})]})}function F({className:t="h-5 w-5"}){return e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",className:t,children:[e.jsx("path",{d:"M4 20h16"}),e.jsx("path",{d:"M7 16v-6M12 16V8M17 16v-3"})]})}function Y({className:t="h-5 w-5"}){return e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",className:t,children:[e.jsx("path",{d:"M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"}),e.jsx("path",{d:"M19.4 15a1.7 1.7 0 0 0 .34 1.87l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06a1.7 1.7 0 0 0-1.87-.34 1.7 1.7 0 0 0-1 1.55V22a2 2 0 1 1-4 0v-.09a1.7 1.7 0 0 0-1-1.55 1.7 1.7 0 0 0-1.87.34l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06a1.7 1.7 0 0 0 .34-1.87 1.7 1.7 0 0 0-1.55-1H2a2 2 0 1 1 0-4h.09a1.7 1.7 0 0 0 1.55-1 1.7 1.7 0 0 0-.34-1.87l-.06-.06a2 2 0 1 1 2.83-2.83l.06.06a1.7 1.7 0 0 0 1.87.34h0a1.7 1.7 0 0 0 1-1.55V2a2 2 0 1 1 4 0v.09a1.7 1.7 0 0 0 1 1.55h0a1.7 1.7 0 0 0 1.87-.34l.06-.06a2 2 0 1 1 2.83 2.83l-.06.06a1.7 1.7 0 0 0-.34 1.87v0a1.7 1.7 0 0 0 1.55 1H22a2 2 0 1 1 0 4h-.09a1.7 1.7 0 0 0-1.55 1z"})]})}function P({className:t="h-5 w-5"}){return e.jsx(N,{className:t})}function U({className:t="h-4 w-4"}){return e.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",className:t,children:e.jsx("path",{d:"m15 18-6-6 6-6"})})}function M({className:t="h-5 w-5"}){return e.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",className:t,children:e.jsx("path",{d:"M3 6h18M3 12h18M3 18h18"})})}function Z({className:t="h-4 w-4"}){return e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",className:t,children:[e.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),e.jsx("path",{d:"M16 17l5-5-5-5"}),e.jsx("path",{d:"M21 12H9"})]})}const Q=(t="")=>String(t).trim().split(" ").filter(Boolean).slice(0,2).map(l=>l[0]).join(""),_={"/admin":"Enterprise Dashboard","/admin/students":"Student Management","/admin/teachers":"Teacher Management","/admin/classes":"Class Management","/admin/subjects":"Subject Management","/admin/schedule":"Scheduling Engine","/admin/feedback":"Ticket Workflow","/admin/surveys":"Survey Lifecycle","/admin/notifications":"Notification Workflow","/admin/import-users":"Bulk Import Users","/admin/reports":"Analytics and Reports","/admin/settings":"System Settings"};function q({collapsed:t,onOpenMobileMenu:l,notificationsCount:x=0}){const{user:i,logout:h}=k(),{pathname:u}=B(),{breadcrumbs:n}=w(),o=_[u]||"Admin",m=(i==null?void 0:i.name)||"Admin User";return e.jsxs("header",{className:`fixed left-0 top-0 z-20 flex h-[64px] items-center justify-between border-b border-gray-100 bg-white px-5 premium-transition ${t?"lg:right-[64px]":"lg:right-[240px]"} right-0`,children:[e.jsxs("div",{className:"flex min-w-0 items-center gap-3",children:[e.jsx("button",{type:"button",onClick:l,className:"flex h-8 w-8 items-center justify-center rounded-md text-gray-400 hover:bg-gray-100 hover:text-gray-600 premium-transition lg:hidden","aria-label":"Open menu",children:e.jsx(M,{className:"h-4 w-4"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h1",{className:"truncate text-[15px] font-semibold text-gray-900",children:o}),e.jsx("p",{className:"truncate text-[11px] text-gray-400",children:n.join(" > ")})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{type:"button",className:"relative flex h-8 w-8 items-center justify-center rounded-md text-gray-400 hover:bg-gray-100 hover:text-gray-600 premium-transition","aria-label":"Notifications",children:[e.jsx(P,{className:"h-4 w-4"}),x>0?e.jsx("span",{className:"absolute right-1 top-1 h-2 w-2 rounded-full bg-red-500"}):null]}),e.jsx("div",{className:"mx-1 h-4 w-px bg-gray-200"}),e.jsxs("div",{className:"flex items-center gap-2 rounded-md px-2 py-1.5",children:[e.jsxs("div",{className:"hidden text-right sm:block",children:[e.jsx("p",{className:"text-[13px] font-semibold leading-tight text-gray-800",children:m}),e.jsx("p",{className:"text-[11px] text-gray-400",children:(i==null?void 0:i.adminProfile)||"admin"})]}),e.jsx("span",{className:"flex h-7 w-7 items-center justify-center rounded-full bg-gray-900 text-[11px] font-bold text-white",children:Q(m)||"A"})]}),e.jsx("div",{className:"mx-1 h-4 w-px bg-gray-200"}),e.jsxs("button",{type:"button",onClick:h,className:"flex items-center gap-1.5 rounded-md px-2.5 py-1.5 text-[13px] font-medium text-gray-500 hover:bg-gray-100 hover:text-gray-700 premium-transition",children:[e.jsx(Z,{className:"h-3.5 w-3.5"}),e.jsx("span",{className:"hidden md:inline",children:"Logout"})]})]})]})}const C=[{key:"main",label:null,items:[{key:"dashboard",label:"Dashboard",to:"/admin",icon:z}]},{key:"entities",label:"Entity Modules",items:[{key:"students",label:"Students",to:"/admin/students",icon:L},{key:"teachers",label:"Teachers",to:"/admin/teachers",icon:V},{key:"classes",label:"Classes",to:"/admin/classes",icon:T},{key:"subjects",label:"Subjects",to:"/admin/subjects",icon:$},{key:"schedule",label:"Scheduling Engine",to:"/admin/schedule",icon:R}]},{key:"workflows",label:"Workflow Modules",items:[{key:"feedback",label:"Ticket Workflow",to:"/admin/feedback",icon:G},{key:"surveys",label:"Survey Lifecycle",to:"/admin/surveys",icon:O},{key:"notifications",label:"Notifications",to:"/admin/notifications",icon:N}]},{key:"system",label:"System",items:[{key:"import-users",label:"Import Users",to:"/admin/import-users",icon:D},{key:"reports",label:"Analytics Reports",to:"/admin/reports",icon:F},{key:"settings",label:"Settings and RBAC",to:"/admin/settings",icon:Y}]}];C.flatMap(t=>t.items);function J({collapsed:t,mobileOpen:l,onToggleCollapse:x,onCloseMobile:i}){var y;const{loading:h,error:u,hierarchy:n,availableYears:o,availableGrades:m,availableClasses:g,selectedYear:r,selectedGrade:b,selectedClassId:S,setSelectedYear:I,setSelectedGrade:v,setSelectedClassId:f}=w();return e.jsxs(e.Fragment,{children:[l?e.jsx("button",{type:"button",onClick:i,className:"fixed inset-0 z-30 bg-black/30 lg:hidden","aria-label":"Close menu"}):null,e.jsxs("aside",{className:`fixed right-0 top-0 z-40 flex h-screen flex-col bg-white premium-transition ${t?"w-[64px]":"w-[240px]"} ${l?"translate-x-0":"translate-x-full"} lg:translate-x-0`,style:{borderLeft:"1px solid #E5E7EB"},children:[e.jsxs("div",{className:`flex h-[64px] shrink-0 items-center border-b border-gray-100 px-4 ${t?"justify-center":"justify-between"}`,children:[t?null:e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"truncate text-sm font-semibold text-gray-900",children:((y=n==null?void 0:n.institution)==null?void 0:y.name)||"Institution"}),e.jsx("p",{className:"mt-px truncate text-[11px] text-gray-400",children:"Enterprise Admin"})]}),e.jsx("span",{className:"flex h-8 w-8 items-center justify-center rounded-lg bg-gray-900 text-xs font-bold text-white",children:"E"}),t?e.jsx("button",{type:"button",onClick:x,className:"absolute bottom-4 right-1/2 hidden h-7 w-7 translate-x-1/2 items-center justify-center rounded-md text-gray-400 hover:bg-gray-100 premium-transition lg:flex","aria-label":"Expand",children:e.jsx(M,{className:"h-3.5 w-3.5"})}):e.jsx("button",{type:"button",onClick:x,className:"hidden h-7 w-7 items-center justify-center rounded-md text-gray-400 hover:bg-gray-100 hover:text-gray-600 premium-transition lg:flex","aria-label":"Collapse",children:e.jsx(U,{className:"h-3.5 w-3.5"})})]}),t?null:e.jsxs("div",{className:"border-b border-gray-100 p-3",children:[e.jsx("p",{className:"mb-2 text-[10px] font-semibold uppercase tracking-widest text-gray-400",children:"Hierarchy Context"}),h?e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"skeleton h-8"}),e.jsx("div",{className:"skeleton h-8"}),e.jsx("div",{className:"skeleton h-8"})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx("select",{value:r,onChange:s=>{var d;const c=s.target.value;I(c);const a=Object.keys(((n==null?void 0:n.hierarchy)||{})[c]||{})[0]||"";v(a);const p=(d=(((n==null?void 0:n.hierarchy)||{})[c]||{})[a])==null?void 0:d[0];f((p==null?void 0:p.id)||"")},className:"focus-ring w-full rounded-sm border border-border bg-white px-2 py-2 text-xs",children:o.map(s=>e.jsx("option",{value:s,children:s},s))}),e.jsx("select",{value:b,onChange:s=>{const c=s.target.value;v(c);const a=((((n==null?void 0:n.hierarchy)||{})[r]||{})[c]||[])[0];f((a==null?void 0:a.id)||"")},className:"focus-ring w-full rounded-sm border border-border bg-white px-2 py-2 text-xs",children:m.map(s=>e.jsx("option",{value:s,children:s},s))}),e.jsx("select",{value:S,onChange:s=>f(s.target.value),className:"focus-ring w-full rounded-sm border border-border bg-white px-2 py-2 text-xs",children:g.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))}),u?e.jsx("p",{className:"text-[10px] text-danger",children:u}):null]})]}),e.jsx("nav",{className:"flex-1 overflow-y-auto px-2.5 py-3",style:{scrollbarWidth:"none"},children:C.map((s,c)=>e.jsxs("div",{className:c>0?"mt-4":"",children:[s.label&&!t?e.jsx("p",{className:"mb-1 px-2 text-[10px] font-semibold uppercase tracking-widest text-gray-400",children:s.label}):null,s.label&&t?e.jsx("div",{className:"mx-auto mb-3 h-px w-6 bg-gray-200"}):null,e.jsx("ul",{className:"space-y-0.5",children:s.items.map(a=>{const p=a.icon;return e.jsx("li",{children:e.jsx(W,{to:a.to,end:a.to==="/admin",onClick:i,className:({isActive:d})=>`group relative flex items-center gap-2.5 rounded-md py-2 text-[13px] font-medium premium-transition ${t?"justify-center px-2":"px-2.5"} ${d?"bg-gray-100 text-gray-900":"text-gray-500 hover:bg-gray-50 hover:text-gray-800"}`,children:({isActive:d})=>e.jsxs(e.Fragment,{children:[d&&!t?e.jsx("span",{className:"absolute right-0 top-1/2 h-4 w-0.5 -translate-y-1/2 rounded-l-full bg-gray-900"}):null,e.jsx(p,{className:`h-4 w-4 shrink-0 ${d?"text-gray-900":"text-gray-400 group-hover:text-gray-600"}`}),t?null:e.jsx("span",{children:a.label}),t?e.jsx("span",{className:"pointer-events-none absolute right-full z-50 mr-2 whitespace-nowrap rounded-md border border-gray-200 bg-white px-2.5 py-1.5 text-xs font-medium text-gray-700 opacity-0 shadow-sm premium-transition group-hover:opacity-100",children:a.label}):null]})})},a.key)})})]},s.key))})]})]})}function te(){const{token:t}=k(),[l,x]=j.useState(!1),[i,h]=j.useState(!1),[u,n]=j.useState(0);return j.useEffect(()=>{if(!t){n(0);return}let o=!0;return(async()=>{var g;try{const r=await E(t);if(!o)return;const b=[Number((r==null?void 0:r.pendingFeedbackTickets)||0)>0,Number(((r==null?void 0:r.scheduleConflicts)||[]).length)>0,Number(((r==null?void 0:r.highRiskStudents)||[]).length)>0,Number(((g=r==null?void 0:r.notificationQueue)==null?void 0:g.unread)||0)>0].filter(Boolean).length;n(b)}catch{o&&n(0)}})(),()=>{o=!1}},[t]),e.jsx(H,{children:e.jsxs("div",{className:"min-h-screen bg-gray-50",dir:"ltr",children:[e.jsx(J,{collapsed:l,mobileOpen:i,onToggleCollapse:()=>x(o=>!o),onCloseMobile:()=>h(!1)}),e.jsxs("div",{className:`premium-transition ${l?"lg:pr-[64px]":"lg:pr-[240px]"}`,children:[e.jsx(q,{collapsed:l,onOpenMobileMenu:()=>h(!0),notificationsCount:u}),e.jsx("main",{className:"px-4 pb-10 pt-[80px] md:px-6 lg:px-8",children:e.jsx(A,{})})]})]})})}export{te as default};
