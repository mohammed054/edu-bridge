import{a as I,r as a,j as e}from"./index-df1SZI71.js";import{j as _,k as J}from"./api-x0wxRGLh.js";import{P as K}from"./PageHeading-CUjM0fdU.js";const Q={overload:"border-danger/30 bg-danger/10 text-danger",underload:"border-warning/30 bg-warning/10 text-warning",balanced:"border-success/30 bg-success/10 text-success"};function ee(){var k,S,v,w,C,T,A,P,$,F,M,W,D;const{token:n}=I(),[l,u]=a.useState([]),[o,j]=a.useState(!0),[E,N]=a.useState(!1),[y,i]=a.useState(""),[r,c]=a.useState(1),[x,L]=a.useState(25),[m,O]=a.useState(1),[H,R]=a.useState(0),[p,U]=a.useState(""),[b,z]=a.useState(""),[B,g]=a.useState(""),[t,h]=a.useState(null),f=a.useMemo(()=>({page:r,pageSize:x,search:p,subject:b}),[r,x,p,b]),V=async()=>{try{j(!0),i("");const s=await _(n,f);u(s.rows||[]),O(Math.max(1,Number(s.totalPages||1))),R(Number(s.totalCount||0))}catch(s){i(s.message||"Failed to load teacher list."),u([])}finally{j(!1)}};a.useEffect(()=>{V()},[n,f]);const q=async s=>{try{N(!0),g(s);const d=await J(n,s);h(d)}catch(d){i(d.message||"Failed to load teacher detail."),h(null)}finally{N(!1)}},G=a.useMemo(()=>[...new Set(l.map(s=>String(s.subject||"").trim()).filter(Boolean))].sort(),[l]);return e.jsxs("div",{className:"page-enter space-y-5 p-1",children:[e.jsx(K,{title:"Enterprise Teacher Management",subtitle:"Workload analytics, conflict warnings, and per-teacher operational dashboards."}),y?e.jsx("p",{className:"rounded-sm border border-danger/25 bg-danger/5 px-3 py-2 text-sm text-danger",children:y}):null,e.jsx("section",{className:"panel-card",children:e.jsxs("div",{className:"grid gap-3 md:grid-cols-4",children:[e.jsx("input",{value:p,onChange:s=>{U(s.target.value),c(1)},className:"focus-ring rounded-sm border border-border px-3 py-2 text-sm",placeholder:"Search teacher name/email"}),e.jsxs("select",{value:b,onChange:s=>{z(s.target.value),c(1)},className:"focus-ring rounded-sm border border-border bg-white px-3 py-2 text-sm",children:[e.jsx("option",{value:"",children:"All subjects"}),G.map(s=>e.jsx("option",{value:s,children:s},s))]}),e.jsx("select",{value:String(x),onChange:s=>{L(Number(s.target.value)),c(1)},className:"focus-ring rounded-sm border border-border bg-white px-3 py-2 text-sm",children:[25,50,100,200].map(s=>e.jsxs("option",{value:s,children:[s," per page"]},s))}),e.jsxs("p",{className:"rounded-sm border border-border bg-background px-3 py-2 text-sm text-text-secondary",children:[H.toLocaleString("en-US")," teachers"]})]})}),e.jsxs("section",{className:"panel-card",children:[o?e.jsxs("div",{className:"grid gap-2",children:[e.jsx("div",{className:"skeleton h-12"}),e.jsx("div",{className:"skeleton h-12"}),e.jsx("div",{className:"skeleton h-12"})]}):e.jsx("div",{className:"overflow-auto",children:e.jsxs("table",{className:"min-w-full border-collapse text-left text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-border bg-background",children:[e.jsx("th",{className:"px-3 py-2 text-xs font-semibold text-text-secondary",children:"Name"}),e.jsx("th",{className:"px-3 py-2 text-xs font-semibold text-text-secondary",children:"Subject"}),e.jsx("th",{className:"px-3 py-2 text-xs font-semibold text-text-secondary",children:"Classes"}),e.jsx("th",{className:"px-3 py-2 text-xs font-semibold text-text-secondary",children:"Weekly Sessions"}),e.jsx("th",{className:"px-3 py-2 text-xs font-semibold text-text-secondary",children:"Weekly Hours"}),e.jsx("th",{className:"px-3 py-2 text-xs font-semibold text-text-secondary",children:"Conflicts"}),e.jsx("th",{className:"px-3 py-2 text-xs font-semibold text-text-secondary",children:"Load"}),e.jsx("th",{className:"px-3 py-2 text-xs font-semibold text-text-secondary",children:"Dashboard"})]})}),e.jsx("tbody",{children:l.length?l.map(s=>e.jsxs("tr",{className:"border-b border-border/60",children:[e.jsxs("td",{className:"px-3 py-2 text-text-primary",children:[e.jsx("p",{className:"font-semibold",children:s.name}),e.jsx("p",{className:"text-xs text-text-secondary",children:s.email})]}),e.jsx("td",{className:"px-3 py-2 text-text-primary",children:s.subject||"-"}),e.jsx("td",{className:"px-3 py-2 text-text-primary",children:(s.classes||[]).join(", ")||"-"}),e.jsx("td",{className:"px-3 py-2 text-text-primary",children:Number(s.weeklySessions||0)}),e.jsx("td",{className:"px-3 py-2 text-text-primary",children:Number(s.weeklyHours||0).toFixed(2)}),e.jsx("td",{className:"px-3 py-2 text-text-primary",children:Number(s.conflictWarnings||0)}),e.jsx("td",{className:"px-3 py-2",children:e.jsx("span",{className:`inline-flex rounded-full border px-2 py-1 text-xs font-semibold ${Q[s.workloadState]||"border-border bg-background text-text-secondary"}`,children:s.workloadState||"unknown"})}),e.jsx("td",{className:"px-3 py-2",children:e.jsx("button",{type:"button",className:"action-btn",onClick:()=>q(s.id),children:"Open"})})]},s.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"px-3 py-8 text-center text-text-secondary",children:"No teachers matched current filters."})})})]})}),e.jsxs("div",{className:"mt-3 flex items-center justify-between gap-3",children:[e.jsxs("p",{className:"text-xs text-text-secondary",children:["Page ",r," of ",m]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",className:"action-btn",onClick:()=>c(s=>Math.max(1,s-1)),disabled:r<=1||o,children:"Previous"}),e.jsx("button",{type:"button",className:"action-btn",onClick:()=>c(s=>Math.min(m,s+1)),disabled:r>=m||o,children:"Next"})]})]})]}),B?e.jsxs("section",{className:"panel-card space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("h2",{className:"text-base font-semibold text-text-primary",children:"Teacher Operational Dashboard"}),e.jsx("button",{type:"button",className:"action-btn",onClick:()=>{g(""),h(null)},children:"Close"})]}),E?e.jsxs("div",{className:"grid gap-2",children:[e.jsx("div",{className:"skeleton h-16"}),e.jsx("div",{className:"skeleton h-16"})]}):t?e.jsxs("div",{className:"grid gap-4 xl:grid-cols-2",children:[e.jsxs("article",{className:"rounded-sm border border-border bg-background p-3",children:[e.jsx("h3",{className:"text-sm font-semibold text-text-primary",children:"Teacher Overview"}),e.jsxs("p",{className:"mt-2 text-xs text-text-secondary",children:[(k=t.teacher)==null?void 0:k.name," | ",(S=t.teacher)==null?void 0:S.email]}),e.jsxs("p",{className:"mt-1 text-xs text-text-secondary",children:["Subject: ",((v=t.teacher)==null?void 0:v.subject)||"-"," | Classes: ",(((w=t.teacher)==null?void 0:w.classes)||[]).join(", ")||"-"]}),e.jsxs("p",{className:"mt-1 text-xs text-text-secondary",children:["Subject Grouping: ",(t.groupingBySubject||[]).map(s=>`${s.subject} (${s.classCount})`).join(", ")||"-"]})]}),e.jsxs("article",{className:"rounded-sm border border-border bg-background p-3",children:[e.jsx("h3",{className:"text-sm font-semibold text-text-primary",children:"Workload Analytics"}),e.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-2 text-xs",children:[e.jsxs("div",{className:"rounded-sm border border-border p-2",children:["Weekly hours: ",Number(((C=t.workloadAnalytics)==null?void 0:C.weeklyHours)||0).toFixed(2)]}),e.jsxs("div",{className:"rounded-sm border border-border p-2",children:["Classes assigned: ",Number(((T=t.workloadAnalytics)==null?void 0:T.classesAssigned)||0)]}),e.jsxs("div",{className:"rounded-sm border border-border p-2",children:["Schedule conflicts: ",Number(((A=t.workloadAnalytics)==null?void 0:A.scheduleConflictWarnings)||0)]}),e.jsxs("div",{className:"rounded-sm border border-border p-2",children:["Attendance submissions: ",Number(((P=t.workloadAnalytics)==null?void 0:P.attendanceCompletionTracker)||0)]}),e.jsxs("div",{className:"rounded-sm border border-border p-2",children:["Risk students: ",Number((($=t.workloadAnalytics)==null?void 0:$.riskStudentsSummary)||0)]}),e.jsxs("div",{className:"rounded-sm border border-border p-2",children:["Upcoming deadlines: ",Number(((F=t.workloadAnalytics)==null?void 0:F.upcomingDeadlines)||0)]})]})]}),e.jsxs("article",{className:"rounded-sm border border-border bg-background p-3 xl:col-span-2",children:[e.jsx("h3",{className:"text-sm font-semibold text-text-primary",children:"Weekly Hour Tracking and Conflict Timeline"}),e.jsx("div",{className:"mt-2 overflow-auto",children:e.jsxs("table",{className:"min-w-full border-collapse text-left text-xs",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-border",children:[e.jsx("th",{className:"px-2 py-1",children:"Class"}),e.jsx("th",{className:"px-2 py-1",children:"Subject"}),e.jsx("th",{className:"px-2 py-1",children:"Day"}),e.jsx("th",{className:"px-2 py-1",children:"Time"}),e.jsx("th",{className:"px-2 py-1",children:"Room"}),e.jsx("th",{className:"px-2 py-1",children:"Conflict Flags"})]})}),e.jsx("tbody",{children:(t.weeklyHourTracking||[]).map(s=>e.jsxs("tr",{className:"border-b border-border/60",children:[e.jsx("td",{className:"px-2 py-1",children:s.className}),e.jsx("td",{className:"px-2 py-1",children:s.subject}),e.jsx("td",{className:"px-2 py-1",children:s.dayOfWeek}),e.jsxs("td",{className:"px-2 py-1",children:[s.startTime," - ",s.endTime]}),e.jsx("td",{className:"px-2 py-1",children:s.room||"-"}),e.jsx("td",{className:"px-2 py-1",children:(s.conflictFlags||[]).join(", ")||"-"})]},`${s.className}-${s.dayOfWeek}-${s.startTime}-${s.subject}`))})]})})]}),e.jsxs("article",{className:"rounded-sm border border-border bg-background p-3",children:[e.jsx("h3",{className:"text-sm font-semibold text-text-primary",children:"Performance Metrics"}),e.jsxs("p",{className:"mt-2 text-xs text-text-secondary",children:["Attendance compliance: ",Number(((M=t.performanceMetrics)==null?void 0:M.attendanceComplianceRate)||0).toFixed(2),"%"]}),e.jsxs("p",{className:"mt-1 text-xs text-text-secondary",children:["Feedback response metric: ",Number(((W=t.performanceMetrics)==null?void 0:W.feedbackResponseTimeMetric)||0)]})]}),e.jsxs("article",{className:"rounded-sm border border-border bg-background p-3",children:[e.jsx("h3",{className:"text-sm font-semibold text-text-primary",children:"Student-Teacher Feedback Cross View"}),e.jsx("div",{className:"mt-2 space-y-2",children:(t.studentTeacherFeedbackCrossView||[]).slice(0,10).map(s=>e.jsxs("div",{className:"rounded-sm border border-border p-2 text-xs",children:[e.jsxs("p",{className:"font-semibold text-text-primary",children:[s.studentName||"Student"," | ",s.className||"-"]}),e.jsxs("p",{className:"text-text-secondary",children:[s.workflowStatus||"-"," | urgency: ",s.urgency||"-"]})]},s._id||`${s.studentName}-${s.createdAt}`))})]}),e.jsxs("article",{className:"rounded-sm border border-border bg-background p-3 xl:col-span-2",children:[e.jsx("h3",{className:"text-sm font-semibold text-text-primary",children:"Parent Communication Log"}),e.jsxs("div",{className:"mt-2 space-y-2",children:[(t.parentCommunicationLog||[]).slice(0,10).map((s,d)=>e.jsxs("div",{className:"rounded-sm border border-border p-2 text-xs",children:[e.jsxs("p",{className:"font-semibold text-text-primary",children:[s.studentName||"Student"," | ",s.className||"-"]}),e.jsx("p",{className:"text-text-secondary",children:s.createdAt?new Date(s.createdAt).toLocaleString("en-US"):"-"})]},`${s.studentName}-${s.createdAt}-${d}`)),(D=t.parentCommunicationLog)!=null&&D.length?null:e.jsx("p",{className:"text-xs text-text-secondary",children:"No parent communication entries found."})]})]})]}):e.jsx("p",{className:"text-sm text-text-secondary",children:"No teacher detail loaded."})]}):null]})}export{ee as default};
